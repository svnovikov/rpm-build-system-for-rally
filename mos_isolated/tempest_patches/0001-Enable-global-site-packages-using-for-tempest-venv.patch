From b329d6fe56d56bdd4fb3379dfebb330711d758c4 Mon Sep 17 00:00:00 2001
From: Dmitry Kalashnik <dkalashnik@mirantis.com>
Date: Mon, 7 Sep 2015 18:18:27 +0300
Subject: [PATCH] Enable global site packages using for tempest venv

---
 tools/install_venv_common.py | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

diff --git a/tools/install_venv_common.py b/tools/install_venv_common.py
index e279159..7cebfa7 100644
--- a/tools/install_venv_common.py
+++ b/tools/install_venv_common.py
@@ -97,15 +97,20 @@ class InstallVenv(object):
                 self.run_command(['virtualenv', '-q', '--no-site-packages',
                                  self.venv])
             else:
-                self.run_command(['virtualenv', '-q', self.venv])
+                # NOTE(dkalashnik): Add explicit flag to allow to use system
+                # packages
+                self.run_command(['virtualenv', '-q',
+                                  '--system-site-packages', self.venv])
             print('done.')
         else:
             print("venv already exists...")
             pass
 
     def pip_install(self, *args):
+        # NOTE(dkalashnik): Remove --upgrade flag to prevent pip from
+        # using PyPI
         self.run_command(['tools/with_venv.sh',
-                         'pip', 'install', '--upgrade'] + list(args),
+                         'pip', 'install'] + list(args),
                          redirect_output=False)
 
     def install_dependencies(self):
-- 
2.3.8 (Apple Git-58)

